<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title></title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- MathJax -->
<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$','$$'], ['\\[','\\]']] },
  options: { renderActions: { addMenu: [] } },
  startup: { typeset: false }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>

<style>
html, body {
  margin: 0;
  height: 100%;
  overflow: hidden;
  background: #f8f8f8;
  font-family: 'Segoe UI', sans-serif;
}

.quiz-container {
  position: absolute;
  top: -40px;
  bottom: 20px;
  left: -10px;
  right: 0;
  overflow-y: auto;
  background: #fff;
  height:80vh;
}

/* HEADER */
.quiz-header {
  background-color: #1b4332;
  background-image: linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
                    linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
  background-size: 20px 20px;
  color: white;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 20px;
  font-weight: 600;
  font-size: 18px;
  position: fixed;
  top: 0;
  left:0;
  right:0;
  z-index: 10;
}

/* BODY */
.quiz-body { padding: 20px 20px 10px; }
.stats { display: flex; justify-content: space-between; margin-bottom: 10px; }

.toggle-nav-btn {
  width: 100%;
  background: #1b4332;
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 8px 0;
  margin-bottom: 8px;
  font-weight: 600;
}

.question-nav { display:flex; flex-wrap:wrap; gap:10px; }
.question-nav button { 
  width:36px; height:36px; border-radius:50%; background:#eee; border:1px solid #ccc; 
}

.correct { border-color: green !important; background: #e8fce8 !important; }
.wrong { border-color: red !important; background: #ffe8e8 !important; }

/* FOOTER */
.quiz-footer {
  position: fixed;
  bottom: 0;
  left: 0;
  right:0;
  width: 100%;
  display: flex;
  justify-content: space-between;
  background-color: #1b4332;
  background-image: 
    linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
  background-size: 20px 20px;
  border-top: 1px solid #ddd;
  padding: 10px;
  box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
}
.quiz-footer button {
  flex: 1;
  background:white;
  color: #1b4332;
  border: none;
  padding: 10px;
  border-radius: 25px;
  font-size: 15px;
  cursor: pointer;
  transition: 0.3s;
  margin: 0 5px;
}
.quiz

/* Option Buttons */
.options label {
  display: block;
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 10px;
  margin-bottom: 8px;
  cursor: pointer;
  transition: all 0.2s;
}
.options label:hover { border-color: #1e3a8a; background: #f0f4ff; }
.correct { border-color: green !important; background: #e8fce8 !important; }
.wrong { border-color: red !important; background: #ffe8e8 !important; }
</style>
</head>
<body>

<!-- MOBILE LOGIN -->
<div id="login-form" style="text-align:center; margin-top:100px;">
  <h2>Login</h2>
  <input type="text" id="mobileInput" placeholder="Enter Mobile Number"
         style="padding:10px; width:80%; max-width:300px; border-radius:8px; border:1px solid #ccc;">
  <br><br>
  <button onclick="validateMobile()" 
          style="background:#1b4332; color:white; padding:10px 20px; border:none; border-radius:8px;">
    Continue
  </button>
</div>

<!-- NAME INPUT -->
<div id="user-form" style="display:none; text-align:center; margin-top:80px;">
  <h3>Enter your Name</h3>
  <input type="text" id="userName" placeholder="Enter Full Name"
         style="padding:10px; width:80%; max-width:300px; border-radius:8px; border:1px solid #ccc;">
  <br><br>
  <button onclick="startQuiz()" 
          style="background:#1b4332; color:white; padding:10px 20px; border:none; border-radius:8px;">
    Start Quiz
  </button>
</div>

<!-- QUIZ -->
<div id="quiz-area" style="display:none;">
<div class="quiz-container">

  <div class="quiz-header">
    <div id="quiz-title">Quiz</div>
    <div>‚è±Ô∏è <span id="timer"></span></div>
    <i class="fa-solid fa-expand" onclick="toggleFullscreen()"></i>
  </div>

  <div class="quiz-body">
    <div class="stats">
      <span id="answered"></span>
      <span id="not-answered"></span>
    </div>

    <button class="toggle-nav-btn" onclick="toggleNav()">üîΩ Show/Hide Questions</button>
    <div class="question-nav" id="question-nav"></div>

    <div id="question-container"></div>
    <div id="result-section"></div>
  </div>

  <div class="quiz-footer">
    <button onclick="prevQuestion()">Previous</button>
    <button onclick="submitQuiz()">Submit</button>
    <button onclick="nextQuestion()">Next</button>
  </div>

</div>
</div>

<script>
// ----------------------------
// MOBILE LOGIN
// ----------------------------
const VALID_MOBILES = ["6301186741", "9876543210", "9999999999"];
let userMobile = "";

function validateMobile(){
  const m = document.getElementById("mobileInput").value.trim();
  if(!VALID_MOBILES.includes(m)){
    alert("Mobile number not registered!");
    return;
  }
  userMobile = m;
  document.getElementById("login-form").style.display="none";
  document.getElementById("user-form").style.display="block";
}

// ----------------------------
// GOOGLE FORM ENTRY IDs
// ----------------------------
const FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSfVoWZdJJTPQhxRCzPhD7UkbMYt13d1pzeWkm7a8Tvbil1P5A/formResponse";

const ENTRY_MOBILE  = "entry.1096987326";
const ENTRY_QUIZ    = "entry.1993342463";
const ENTRY_SCORE   = "entry.1053562570";
const ENTRY_CORRECT = "entry.1154826868";
const ENTRY_WRONG   = "entry.1442969806";
const ENTRY_SKIP    = "entry.770173959";

const QUIZ_TITLE = "Quadratic Equations";

// ----------------------------
// QUESTIONS
// ----------------------------
const questions = [
  { q:"Select the most appropriate option to substitute the underlined segment.<br> Ranveer never has the habit of <u>making a beeline</u> for his academic activities.", 
    options:["behaving abnormally","selecting inconsiderately","going straight and quick","immediately responding to things"], answerId:2 },
    
  { q:"Select the passive voice.<br>Rohit did not slap Kunal.",
    options:["Kunal was not being slapped by Rohit.","Kunal had not been slapped by Rohit.","Kunal was not slapped by Rohit.","Kunal has not been slapped by Rohit."], answerId:2},

  { q:"Meaning of the idiom <u>the tip of the iceberg</u>.",
    options:["non-existent issue","solvable small problem","large visible part","small part of large hidden problem"], answerId:3}
];

let current=0;
let answers=Array(questions.length).fill(null);
let submitted=false;
let timeLeft=questions.length*60;
let timerInterval;

// ----------------------------
// QUIZ START
// ----------------------------
function startQuiz(){
  const name=document.getElementById("userName").value.trim();
  if(!name){alert("Enter name");return;}

  document.getElementById("user-form").style.display="none";
  document.getElementById("quiz-area").style.display="block";

  renderNav();
  renderQuestion();
  startTimer();
}

function toggleNav(){ 
  document.getElementById("question-nav").classList.toggle("hidden"); 
}

function renderNav(){
  const nav=document.getElementById("question-nav");
  nav.innerHTML="";
  questions.forEach((_,i)=>{
    const b=document.createElement("button");
    b.textContent=i+1;

    if(i===current) b.style.background="#cdeaff";
    if(answers[i]!=null) b.style.borderColor="green";

    b.onclick=()=>{current=i;renderQuestion()};
    nav.appendChild(b);
  });
  updateStats();
}

// ----------------------------
// MAIN QUESTION RENDERING
// ----------------------------
function renderQuestion(){
  const q = questions[current];
  
  let html = `<h4>Question ${current+1}/${questions.length}</h4><p>${q.q}</p><div class='options'>`;

  q.options.forEach((o, i) => {
    let cls = "";
    
    if(!submitted && answers[current] === i) cls = "selected";
    if(submitted){
      if(i === q.answerId) cls = "correct disabled";
      else if(answers[current] === i) cls = "wrong disabled";
      else cls="disabled";
    }

    html += `
      <label class="${cls}" onclick="selectOpt(${i})">
        <input type="radio" name="opt" value="${i}" ${answers[current]===i?"checked":""}>
        ${o}
      </label>
    `;
  });

  html += `</div>`;
  document.getElementById("question-container").innerHTML = html;

  if(window.MathJax && MathJax.typesetPromise) MathJax.typesetPromise();
}

function selectOpt(i){
  if(submitted) return;
  answers[current] = i;
  renderQuestion();
  renderNav();
}

function nextQuestion(){ if(current<questions.length-1){ current++; renderQuestion(); } }
function prevQuestion(){ if(current>0){ current--; renderQuestion(); } }

function updateStats(){
  const a=answers.filter(x=>x!==null).length;
  document.getElementById("answered").textContent=`Answered: ${a}`;
  document.getElementById("not-answered").textContent=`Not Answered: ${questions.length-a}`;
}

// ----------------------------
// TIMER
// ----------------------------
function startTimer(){
  timerInterval=setInterval(()=>{
    timeLeft--;
    document.getElementById("timer").textContent=`${Math.floor(timeLeft/60)}:${String(timeLeft%60).padStart(2,'0')}`;
    if(timeLeft<=0){ clearInterval(timerInterval); submitQuiz(); }
  },1000);
}

// ----------------------------
// SUBMIT QUIZ
// ----------------------------
function submitQuiz(){
  if(submitted) return;
  submitted=true;

  clearInterval(timerInterval);

  let correct=0, wrong=0;
  questions.forEach((q,i)=>{
    if(answers[i]!=null){
      if(answers[i]===q.answerId) correct++;
      else wrong++;
    }
  });

  const skipped = questions.length - (correct + wrong);
  const score = Math.round((correct/questions.length)*100);
  const name = document.getElementById("userName").value;

  // SEND TO GOOGLE FORM
  const formData = new FormData();
  formData.append(ENTRY_MOBILE, userMobile);
  formData.append(ENTRY_QUIZ, QUIZ_TITLE);
  formData.append(ENTRY_SCORE, score);
  formData.append(ENTRY_CORRECT, correct);
  formData.append(ENTRY_WRONG, wrong);
  formData.append(ENTRY_SKIP, skipped);

  fetch(FORM_URL, { method:"POST", mode:"no-cors", body:formData });

  renderQuestion();
  renderNav();

  document.getElementById("result-section").innerHTML = `
    <h3>Results</h3>
    <p><b>Name:</b> ${name}</p>
    <p><b>Mobile:</b> ${userMobile}</p>
    <p><b>Score:</b> ${score}%</p>
    <p><b>Correct:</b> ${correct}</p>
    <p><b>Wrong:</b> ${wrong}</p>
    <p><b>Skipped:</b> ${skipped}</p>
  `;
}

// ----------------------------
// FULL SCREEN
// ----------------------------
function toggleFullscreen(){
  if(!document.fullscreenElement) document.documentElement.requestFullscreen();
  else document.exitFullscreen();
}

</script>

</body>
</html>
